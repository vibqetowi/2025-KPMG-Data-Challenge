// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

Table employees {
  personnel_no integer [primary key]
  employee_name varchar
  staff_level varchar
  is_external bool
}

Table clients {
  client_no integer [primary key]
  client_name varchar
}

Table engagements {
  eng_no integer [primary key]
  eng_description varchar
  client_no integer
}

Table phases {
  eng_no integer
  eng_phase integer
  phase_description varchar
  budget decimal
  
  indexes {
    (eng_no, eng_phase) [pk] // composite primary key
  }
}

Table staffing {
  id integer [primary key]
  personnel_no integer
  eng_no integer
  eng_phase integer
  week_start_date date [note: 'First Monday of the week, e.g. 2025-01-06']
  planned_hours decimal
}

Table timesheets {
  id integer [primary key]
  personnel_no integer
  eng_no integer
  eng_phase integer
  work_date date
  hours decimal
  time_entry_date date
  posting_date date
  charge_out_rate decimal
  std_price decimal
  adm_surcharge decimal
}

Table dictionary {
  key varchar [primary key]
  description varchar
}

// Foreign key references moved to the end
Ref: engagements.client_no > clients.client_no
Ref: phases.eng_no > engagements.eng_no
Ref: staffing.personnel_no > employees.personnel_no
Ref: staffing.(eng_no, eng_phase) > phases.(eng_no, eng_phase)
Ref: timesheets.personnel_no > employees.personnel_no
Ref: timesheets.(eng_no, eng_phase) > phases.(eng_no, eng_phase)
